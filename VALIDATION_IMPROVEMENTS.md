# ?? C?i Thi?n Nghi?p V? Validate cho MeetingTest.cs

## ?? T?ng Quan
File này ch?a t?t c? các c?i thi?n validation ?ã ???c thêm vào `MeetingTest.cs` ?? ??m b?o tính toàn v?n d? li?u và tr?i nghi?m ng??i dùng t?t h?n.

---

## ? 1. Validation Th?i Gian

### 1.1. Ki?m tra ??nh d?ng th?i gian
```csharp
private bool ValidateTime(string timeStr)
```
**Ch?c n?ng:**
- Ki?m tra ??nh d?ng HH:mm (ví d?: 08:00, 14:30)
- S? d?ng Regex ?? validate pattern
- Ki?m tra giá tr? h?p l? (gi?: 0-23, phút: 0-59)

**L?i ích:**
- ??m b?o th?i gian nh?p vào ?úng ??nh d?ng
- Tránh l?i khi l?u vào database

### 1.2. Ki?m tra kho?ng th?i gian h?p l?
```csharp
private bool ValidateTimeRange(string startTime, string endTime, out string errorMessage)
```
**Ch?c n?ng:**
- ? **Gi? b?t ??u:** Ph?i t? 07:00 sáng tr? ?i
- ? **Gi? k?t thúc:** Không ???c quá 21:00 t?i
- ? Ki?m tra gi? b?t ??u ph?i tr??c gi? k?t thúc
- ? Ki?m tra th?i l??ng t?i thi?u (15 phút)
- ? Ki?m tra th?i l??ng t?i ?a (14 gi?)
- ? Tr? v? thông báo l?i chi ti?t

**Các tr??ng h?p ???c x? lý:**
- ? Gi? b?t ??u < 07:00
- ? Gi? b?t ??u > 21:00
- ? Gi? k?t thúc > 21:00
- ? Gi? k?t thúc <= gi? b?t ??u
- ? Th?i l??ng < 15 phút
- ? Th?i l??ng > 14 gi?
- ? Khung gi? h?p l?: 07:00 - 21:00

**Ví d?:**
```
? H?p l?: 08:00 - 10:00 (2 gi?)
? H?p l?: 07:00 - 21:00 (14 gi? - t?i ?a)
? H?p l?: 13:30 - 15:45 (2 gi? 15 phút)
? Không h?p l?: 06:30 - 10:00 (b?t ??u quá s?m)
? Không h?p l?: 18:00 - 22:00 (k?t thúc quá mu?n)
? Không h?p l?: 20:00 - 20:10 (d??i 15 phút)
```
---

## ? 2. Validation Xung ??t S? Ki?n

### 2.1. Ki?m tra trùng l?ch
```csharp
private EventInfo CheckEventConflict(DateTime date, string startTime, string endTime, int? excludeEventId = null)
```
**Ch?c n?ng:**
- Ki?m tra xem có s? ki?n nào trùng th?i gian không
- H? tr? lo?i tr? s? ki?n hi?n t?i khi s?a
- Phát hi?n các tr??ng h?p overlap:
  - S? ki?n m?i b?t ??u trong kho?ng th?i gian c?
  - S? ki?n m?i k?t thúc trong kho?ng th?i gian c?
  - S? ki?n m?i bao ph? hoàn toàn s? ki?n c?

**L?i ích:**
- Tránh tình tr?ng double booking
- C?nh báo ng??i dùng khi có xung ??t
- Cho phép ng??i dùng quy?t ??nh có ti?p t?c hay không

### 2.2. Chuy?n ??i th?i gian sang phút
```csharp
private int TimeToMinutes(string time)
```
**Ch?c n?ng:**
- Chuy?n ??i th?i gian HH:mm thành t?ng s? phút
- H? tr? so sánh th?i gian d? dàng h?n

---

## ? 3. Validation Tiêu ?? S? Ki?n

### 3.1. Ki?m tra tiêu ?? h?p l?
```csharp
private bool ValidateEventTitle(string title, out string errorMessage)
```
**Ch?c n?ng:**
- Ki?m tra không ???c ?? tr?ng
- ?? dài t?i thi?u: 3 ký t?
- ?? dài t?i ?a: 255 ký t?
- Không ch?a ký t? ??c bi?t không h?p l?: `<>|"*?\/`

**Các tr??ng h?p ???c x? lý:**
- ? Tiêu ?? r?ng ho?c ch? có kho?ng tr?ng
- ? Tiêu ?? quá ng?n (< 3 ký t?)
- ? Tiêu ?? quá dài (> 255 ký t?)
- ? Ch?a ký t? ??c bi?t không h?p l?
- ? Tiêu ?? h?p l?

---

## ? 4. Validation ??a ?i?m

### 4.1. Ki?m tra ??a ?i?m h?p l?
```csharp
private bool ValidateLocation(string location, out string errorMessage)
```
**Ch?c n?ng:**
- Ki?m tra không ???c ?? tr?ng
- ?? dài t?i thi?u: 2 ký t?
- ?? dài t?i ?a: 255 ký t?

**L?i ích:**
- ??m b?o thông tin ??a ?i?m ??y ??
- Tránh l?i khi hi?n th? và tìm ki?m

---

## ? 5. Validation Ngày S? Ki?n (?ã có - ???c c?i thi?n)

### 5.1. Ki?m tra ngày h?p l?
```csharp
private bool ValidateEventDate(DateTime eventDate, string action = "thêm")
```
**Ch?c n?ng:**
- Không cho phép ch?n ngày trong quá kh?
- C?nh báo khi ch?n ngày quá xa trong t??ng lai (> 2 n?m)
- Thông báo l?i chi ti?t v?i ngày c? th?

---

## ? 6. Validation Email (?ã có - ???c c?i thi?n)

### 6.1. Ki?m tra email h?p l?
```csharp
private bool IsValidEmail(string email)
```
**Ch?c n?ng:**
- Ki?m tra ??nh d?ng email b?ng Regex
- Xác th?c b?ng MailAddress class
- ??m b?o email có @ và domain h?p l?

---

## ? 7. C?i Thi?n G?i Email

### 7.1. Validation thông tin g?i email
**Các ki?m tra ???c thêm vào `btnGuiEmail_Click`:**

1. **Email ng??i g?i:**
   - ? Ph?i h?p l?
   - ? ?úng ??nh d?ng email

2. **M?t kh?u:**
   - ? Không ???c ?? tr?ng

3. **SMTP Host:**
   - ? Không ???c ?? tr?ng

4. **Port:**
   - ? Ph?i trong kho?ng 1-65535

5. **Tiêu ?? email:**
   - ? Không ???c ?? tr?ng
   - ? Không quá 255 ký t?

6. **N?i dung email:**
   - ? Không ???c ?? tr?ng

7. **Email ng??i nh?n:**
   - ? L?c và validate t?ng email
   - ? Hi?n th? danh sách email không h?p l?
   - ? B? qua email không h?p l? khi g?i

8. **X? lý l?i:**
   - ? B?t riêng SmtpException
   - ? Timeout 30 giây cho m?i email
   - ? Hi?n th? chi ti?t l?i

---

## ? 8. C?i Thi?n Thêm/S?a S? Ki?n

### 8.1. Thêm s? ki?n m?i (`btnThemSuKien_Click`)
**Các b??c validation:**

1. ? Validate ngày s? ki?n
2. ? Validate tiêu ??
3. ? Validate kho?ng th?i gian (07:00 - 21:00)
4. ? Ki?m tra xung ??t s? ki?n (v?i c?nh báo)
5. ? Validate ??a ?i?m (n?u có)
6. ? L?u vào database

### 8.2. S?a s? ki?n (`btnSuaSuKien_Click`)
**Các b??c validation:**

1. ? Validate ngày s? ki?n (n?u thay ??i)
2. ? C?nh báo n?u s?a s? ki?n trong quá kh?
3. ? Validate tiêu ??
4. ? Validate kho?ng th?i gian (07:00 - 21:00)
5. ? Ki?m tra xung ??t (lo?i tr? s? ki?n hi?n t?i)
6. ? Validate ??a ?i?m (n?u có)
7. ? C?p nh?t database

---

## ?? Th?ng Kê C?i Thi?n

### Tr??c khi c?i thi?n:
- ? Không ki?m tra th?i gian h?p l?
- ? Không ki?m tra xung ??t s? ki?n
- ? Validate tiêu ?? và ??a ?i?m ??n gi?n
- ? Không gi?i h?n th?i l??ng s? ki?n
- ? Email validation c? b?n
- ? Không gi?i h?n gi? làm vi?c

### Sau khi c?i thi?n:
- ? Validate th?i gian ??y ?? (??nh d?ng, range, duration)
- ? **Gi?i h?n gi? làm vi?c: 07:00 - 21:00**
- ? Phát hi?n và c?nh báo xung ??t s? ki?n
- ? Validate tiêu ?? và ??a ?i?m chi ti?t
- ? Gi?i h?n th?i l??ng h?p lý (15 phút - 14 gi?)
- ? Email validation toàn di?n
- ? X? lý l?i chi ti?t và thông báo rõ ràng

---

## ?? L?i Ích C?a Các C?i Thi?n

### 1. Tr?i nghi?m ng??i dùng t?t h?n:
- ? Thông báo l?i chi ti?t và d? hi?u
- ? Ng?n ch?n l?i tr??c khi l?u vào database
- ? H? tr? ng??i dùng s?a l?i nhanh chóng

### 2. Tính toàn v?n d? li?u:
- ? ??m b?o d? li?u h?p l? tr??c khi l?u
- ? Tránh duplicate và xung ??t
- ? Gi?m thi?u l?i runtime

### 3. B?o trì và m? r?ng:
- ? Code d? ??c và maintain
- ? Các hàm validation có th? tái s? d?ng
- ? D? dàng thêm rule m?i

### 4. B?o m?t và hi?u n?ng:
- ? Validate input ?? tránh SQL injection
- ? Gi?i h?n kích th??c d? li?u
- ? Timeout cho email g?i

### 5. Tuân th? quy ??nh gi? làm vi?c:
- ? **Ch? cho phép ??t s? ki?n t? 07:00 - 21:00**
- ? Phù h?p v?i gi? làm vi?c th?c t?
- ? Tránh ??t l?ch ngoài gi? làm vi?c

---

## ?? H??ng D?n S? D?ng

### Khi thêm s? ki?n m?i:
1. Ch?n ngày trên l?ch
2. Click "Thêm s? ki?n m?i"
3. Nh?p thông tin (h? th?ng s? validate t? ??ng)
4. **L?u ý:** Ch? ???c ch?n gi? t? 07:00 ??n 21:00
5. N?u có l?i, s?a theo thông báo
6. L?u thành công

### Khi s?a s? ki?n:
1. Click vào s? ki?n c?n s?a
2. Click "S?a s? ki?n"
3. Ch?nh s?a thông tin
4. **L?u ý:** Gi? v?n ph?i trong kho?ng 07:00 - 21:00
5. H? th?ng s? c?nh báo n?u có xung ??t
6. Xác nh?n và l?u

### Khi g?i email:
1. Ch?n s? ki?n
2. Click "G?i email"
3. Nh?p thông tin SMTP ??y ??
4. H? th?ng s? validate và g?i
5. Xem k?t qu? g?i chi ti?t

---

## ?? Ghi Chú Quan Tr?ng

1. **? Gi? làm vi?c:**
   - **Gi? b?t ??u s?m nh?t:** 07:00
   - **Gi? k?t thúc mu?n nh?t:** 21:00
   - **Th?i l??ng t?i thi?u:** 15 phút
   - **Th?i l??ng t?i ?a:** 14 gi? (07:00 - 21:00)

2. **Xung ??t s? ki?n:**
   - H? th?ng ch? c?nh báo, không ch?n hoàn toàn
   - Ng??i dùng có th? quy?t ??nh ti?p t?c

3. **Email:**
   - Timeout: 30 giây m?i email
   - Email không h?p l? s? b? b? qua
   - Hi?n th? chi ti?t k?t qu? g?i

4. **Ngày s? ki?n:**
   - Không cho phép ch?n quá kh?
   - C?nh báo n?u ch?n > 2 n?m sau

---

## ?? Phát Tri?n Ti?p Theo (?? xu?t)

1. ? Thêm validation cho s? l??ng ng??i tham gia
2. ? Ki?m tra capacity c?a phòng h?p
3. ? Tích h?p v?i calendar API (Google Calendar, Outlook)
4. ? Thêm reminder t? ??ng
5. ? Xu?t file iCalendar (.ics)
6. ? Tính n?ng recurring events
7. ? Validate quy?n h?n ng??i dùng
8. ? Log history thay ??i
9. ? C?u hình gi? làm vi?c linh ho?t (admin setting)
10. ? Thêm break time (gi? ngh? tr?a)

---

## ?? Tài Li?u Tham Kh?o

- [C# Regex Documentation](https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expressions)
- [SmtpClient Class](https://docs.microsoft.com/en-us/dotnet/api/system.net.mail.smtpclient)
- [Input Validation Best Practices](https://owasp.org/www-project-proactive-controls/v3/en/c5-validate-inputs)

---

**Tác gi?:** GitHub Copilot  
**Ngày c?p nh?t:** 2024  
**Version:** 2.0 - Thêm gi?i h?n gi? làm vi?c 07:00 - 21:00

# Tính n?ng: ??ng b? th?i gian gi?a Form Ch?n Phòng và Form S? ki?n

## ?? Mô t?
Khi ng??i dùng thay ??i th?i gian trong form ch?n phòng, th?i gian ?ó s? t? ??ng ???c c?p nh?t ra form thêm/s?a s? ki?n bên ngoài.

## ?? Quy trình ho?t ??ng

### 1. M? form ch?n phòng
```
Form S? ki?n                    Form Ch?n Phòng
????????????????                ????????????????
? Ngày: 23/12  ?   Click "??"   ? Ngày: 23/12  ?
? T?:   08:00  ?   ?????????    ? T?:   08:00  ?
? ??n:  10:00  ?                ? ??n:  10:00  ?
????????????????                ????????????????
                                (Nh?n th?i gian t? form cha)
```

### 2. Thay ??i th?i gian trong form ch?n phòng
```
Form Ch?n Phòng
??????????????????????????????????
? Ngày: [24/12/2025]             ?
? T?:   [14:00] ??n: [16:00]    ?
?         [? Áp d?ng]            ?
??????????????????????????????????
         ?
         ? User thay ??i th?i gian
         ?
??????????????????????????????????
? Th?i gian ???c l?u vào:        ?
? • SelectedDate                 ?
? • SelectedStartTime            ?
? • SelectedEndTime              ?
??????????????????????????????????
```

### 3. Ch?n phòng và xác nh?n
```
Form Ch?n Phòng
??????????????????????????????????
? Ch?n DN ? T?ng 1 ? Phòng 101   ?
?                                 ?
? [Xác nh?n]                     ?
??????????????????????????????????
         ?
         ? Click Xác nh?n
         ?
??????????????????????????????????
? Tr? v? form cha:               ?
? • SelectedRoom = "DN.101"      ?
? • SelectedDate = 24/12/2025    ?
? • SelectedStartTime = "14:00"  ?
? • SelectedEndTime = "16:00"    ?
??????????????????????????????????
```

### 4. C?p nh?t form s? ki?n
```
Form S? ki?n (SAU)
????????????????????????????????
? Ngày:     [24/12/2025]       ? ? ???c c?p nh?t
? T?:       [14:00]            ? ? ???c c?p nh?t
? ??n:      [16:00]            ? ? ???c c?p nh?t
? ??a ?i?m: [DN.101]           ? ? ???c c?p nh?t
????????????????????????????????
```

## ?? Code Implementation

### RoomSelectionForm.cs

#### Properties tr? v?
```csharp
public string SelectedRoom { get; private set; }
public DateTime SelectedDate { get; private set; }
public string SelectedStartTime { get; private set; }
public string SelectedEndTime { get; private set; }
```

#### Khi click "? Áp d?ng"
```csharp
private void BtnApplyTime_Click(object sender, EventArgs e)
{
    // Validate th?i gian
    if (!ValidateTime(mtbStartTime.Text) || !ValidateTime(mtbEndTime.Text))
        return;
    
    // L?u th?i gian - s? ???c tr? v? form cha
    SelectedDate = dtpDate.Value.Date;
    SelectedStartTime = mtbStartTime.Text;
    SelectedEndTime = mtbEndTime.Text;
    
    // C?p nh?t UI
    lblSelectedTime.Text = $"Th?i gian: {SelectedDate:dd/MM/yyyy} {SelectedStartTime}-{SelectedEndTime}";
}
```

#### Khi click "Xác nh?n"
```csharp
private void BtnConfirm_Click(object sender, EventArgs e)
{
    // ??m b?o th?i gian ???c l?u t? controls
    SelectedDate = dtpDate.Value.Date;
    SelectedStartTime = mtbStartTime.Text;
    SelectedEndTime = mtbEndTime.Text;
    
    this.DialogResult = DialogResult.OK;
    this.Close();
}
```

### frmAddEditEvent.cs

#### Nh?n th?i gian t? form ch?n phòng
```csharp
private void btnSelectRoom_Click(object sender, EventArgs e)
{
    using (var roomForm = new RoomSelectionForm(
        dtpDate.Value.Date, 
        existingEvents, 
        txtLocation.Text,
        mtbStartTime.Text,      // Truy?n th?i gian vào
        mtbEndTime.Text))
    {
        if (roomForm.ShowDialog() == DialogResult.OK)
        {
            // C?p nh?t ??a ?i?m
            txtLocation.Text = roomForm.SelectedRoom;
            
            // ? C?p nh?t th?i gian t? form ch?n phòng
            dtpDate.Value = roomForm.SelectedDate;
            mtbStartTime.Text = roomForm.SelectedStartTime.Replace(":", "");
            mtbEndTime.Text = roomForm.SelectedEndTime.Replace(":", "");
        }
    }
}
```

## ?? Use Cases

### Use Case 1: Thay ??i th?i gian ?? tìm phòng tr?ng

**Tình hu?ng:**
- User mu?n ??t phòng DN.101 lúc 14:00-16:00
- Th?y phòng màu xám (?ã ??t)
- Quy?t ??nh ??i sang 16:00-18:00

**Các b??c:**
```
1. M? form ch?n phòng (th?i gian ban ??u: 14:00-16:00)
2. Th?y DN.101 màu xám
3. ??i th?i gian: 16:00-18:00
4. Click "? Áp d?ng"
5. DN.101 chuy?n sang màu tr?ng (có th? ??t)
6. Click ch?n DN.101
7. Click "Xác nh?n"
8. Quay l?i form s? ki?n:
   ? Th?i gian: 16:00-18:00 (?ã c?p nh?t)
   ? ??a ?i?m: DN.101
```

### Use Case 2: Thay ??i c? ngày và gi?

**Tình hu?ng:**
- Ban ??u: 23/12/2025, 08:00-10:00
- Sau khi ch?n phòng: 24/12/2025, 14:00-16:00

**K?t qu?:**
```
Form S? ki?n (TR??C)          Form S? ki?n (SAU)
???????????????????            ???????????????????
? Ngày: 23/12     ?            ? Ngày: 24/12     ? ?
? T?:   08:00     ?   ?????    ? T?:   14:00     ? ?
? ??n:  10:00     ?            ? ??n:  16:00     ? ?
? Phòng: [____]   ?            ? Phòng: DN.101   ? ?
???????????????????            ???????????????????
```

### Use Case 3: Không thay ??i th?i gian

**Tình hu?ng:**
- Không ??i th?i gian trong form ch?n phòng
- Ch? ch?n phòng và xác nh?n

**K?t qu?:**
```
Th?i gian ban ??u: 14:00-16:00
          ?
    (Không ??i)
          ?
Th?i gian sau: 14:00-16:00 (gi? nguyên)
```

## ? Ki?m tra

### Test Case 1: C?p nh?t th?i gian
```
Input:  Th?i gian ban ??u 08:00-10:00
Action: ??i thành 14:00-16:00, click "Áp d?ng", ch?n phòng, xác nh?n
Output: Form s? ki?n hi?n th? 14:00-16:00 ?
```

### Test Case 2: C?p nh?t ngày
```
Input:  Ngày 23/12/2025
Action: ??i thành 24/12/2025, click "Áp d?ng", ch?n phòng, xác nh?n
Output: Form s? ki?n hi?n th? 24/12/2025 ?
```

### Test Case 3: Không áp d?ng th?i gian m?i
```
Input:  Th?i gian 08:00-10:00
Action: ??i thành 14:00-16:00, KHÔNG click "Áp d?ng"
Output: V?n gi? th?i gian c? 08:00-10:00 ?
```

### Test Case 4: H?y b?
```
Input:  Th?i gian 08:00-10:00
Action: ??i thành 14:00-16:00, click "Áp d?ng", click "H?y"
Output: Form s? ki?n gi? nguyên 08:00-10:00 (không thay ??i) ?
```

## ?? UI Flow

```
???????????????????????????????????????????????????
?            Form Thêm/S?a S? ki?n                ?
? ??????????????????????????????????????????????? ?
? ? Tiêu ??:  [H?p nhóm d? án            ]      ? ?
? ? Ngày:     [23/12/2025]                      ? ?
? ? Gi? B?:   [08:00]  Gi? KT: [10:00]         ? ?
? ? ??a ?i?m: [________________] [?? Ch?n]     ? ?
? ??????????????????????????????????????????????? ?
???????????????????????????????????????????????????
                      ?
                      ? Click [?? Ch?n]
                      ?
???????????????????????????????????????????????????
?            Form Ch?n Phòng H?c                  ?
? ??????????????????????????????????????????????? ?
? ? 1. Ch?n th?i gian:                          ? ?
? ? ??????????????????????????????????????????? ? ?
? ? ? Ngày: [24/12/2025]                      ? ? ?
? ? ? T?: [14:00] ??n: [16:00]               ? ? ?
? ? ?        [? Áp d?ng] ? Click ?? l?u      ? ? ?
? ? ??????????????????????????????????????????? ? ?
? ?                                              ? ?
? ? 2. Ch?n dãy nhà: [DN] [E3] [E4]...          ? ?
? ? 3. Ch?n t?ng:    [T?ng 1] [T?ng 2]...       ? ?
? ? 4. Ch?n phòng:   [101] [102] [103]...       ? ?
? ?                                              ? ?
? ?          [Xác nh?n]  [H?y] ? Click xác nh?n ? ?
? ??????????????????????????????????????????????? ?
???????????????????????????????????????????????????
                      ?
                      ? Click [Xác nh?n]
                      ?
???????????????????????????????????????????????????
?            Form Thêm/S?a S? ki?n                ?
? ??????????????????????????????????????????????? ?
? ? Tiêu ??:  [H?p nhóm d? án            ]      ? ?
? ? Ngày:     [24/12/2025]  ? ?ã c?p nh?t       ? ?
? ? Gi? B?:   [14:00]       ? ?ã c?p nh?t       ? ?
? ? Gi? KT:   [16:00]       ? ?ã c?p nh?t       ? ?
? ? ??a ?i?m: [DN.101]      ? ?ã c?p nh?t       ? ?
? ??????????????????????????????????????????????? ?
???????????????????????????????????????????????????
```

## ?? So sánh Before/After

### BEFORE (Không ??ng b?)
```
? V?n ??:
- User ??i th?i gian trong form ch?n phòng
- Nh?ng th?i gian không ???c l?u
- Ph?i nh?p l?i th?i gian ? form s? ki?n
- D? quên và nh?m l?n
```

### AFTER (Có ??ng b?)
```
? Gi?i pháp:
- User ??i th?i gian trong form ch?n phòng
- Click "Áp d?ng" ? Th?i gian ???c l?u
- Click "Xác nh?n" ? Th?i gian t? ??ng c?p nh?t ra form cha
- Ti?t ki?m th?i gian, tránh nh?m l?n
```

## ?? Technical Details

### Data Flow
```
RoomSelectionForm                    frmAddEditEvent
     ?                                     ?
     ? 1. Constructor                     ?
     ? ????????????????????????????????????
     ?    (nh?n th?i gian ban ??u)        ?
     ?                                     ?
     ? 2. User thay ??i th?i gian         ?
     ?    Click "? Áp d?ng"               ?
     ?    ? L?u vào properties             ?
     ?                                     ?
     ? 3. Click "Xác nh?n"                ?
     ? ????????????????????????????????????
     ?    (tr? v? properties)             ?
     ?                                     ?
     ?                                     ? 4. C?p nh?t controls
     ?                                     ?    dtpDate.Value = ...
     ?                                     ?    mtbStartTime.Text = ...
     ?                                     ?    mtbEndTime.Text = ...
```

### Properties Mapping
```
RoomSelectionForm          ?    frmAddEditEvent
?????????????????????????????????????????????????
SelectedDate              ?    dtpDate.Value
SelectedStartTime         ?    mtbStartTime.Text
SelectedEndTime           ?    mtbEndTime.Text
SelectedRoom              ?    txtLocation.Text
```

## ?? L?i ích

1. **UX t?t h?n**
   - Không ph?i nh?p l?i th?i gian
   - T? ??ng ??ng b?

2. **Tránh sai sót**
   - ??m b?o th?i gian kh?p v?i phòng ?ã ch?n
   - Không b? nh?m l?n gi?a 2 form

3. **Ti?t ki?m th?i gian**
   - Gi?m s? b??c thao tác
   - Workflow m??t mà h?n

4. **Linh ho?t**
   - V?n có th? ??i th?i gian trong form ch?n phòng
   - T? ??ng ki?m tra phòng tr?ng theo th?i gian m?i

---

**Version**: 2.1  
**Updated**: 23/12/2025  
**Build Status**: ? Success
